"""
项目文件说明和快速指南
"""

FILES_OVERVIEW = \"\"\"
📦 RecSystem - 双智能体推荐系统
════════════════════════════════════════════════════════════════

【核心配置】
├─ config.py              
│  ├─ 设备选择（GPU > MPS > CPU）
│  ├─ 模型配置（Qwen2.5-0.5B）
│  ├─ 系统参数设置
│  └─ 推荐数量、演化阈值等
│
├─ requirements.txt
│  ├─ transformers, torch
│  ├─ networkx, pydantic
│  └─ 其他依赖

【核心模块】
├─ interest_graph.py          ⭐⭐⭐
│  ├─ InterestGraph 类
│  ├─ 有向图数据结构
│  ├─ 兴趣权重管理（指数移动平均）
│  ├─ 兴趣衰减机制（周期衰减）
│  ├─ 图谱自动修剪
│  └─ 序列化/反序列化
│
├─ agent_a.py               ⭐⭐⭐
│  ├─ AgentA - 推荐智能体
│  ├─ 基于Qwen2.5的推荐生成
│  ├─ 推荐排序和优化
│  ├─ 版本管理
│  ├─ 统计信息收集
│  └─ 改进应用接口
│
├─ agent_b.py               ⭐⭐⭐
│  ├─ AgentB - 评估改进智能体
│  ├─ FeedbackMetrics - 反馈度量
│  ├─ 质量评估（4个维度）
│  ├─ 问题识别
│  ├─ 改进建议生成
│  ├─ 自我改进（规则学习）
│  ├─ 演化触发判断
│  └─ 指导生成
│
├─ evolution_manager.py     ⭐⭐⭐
│  ├─ EvolutionManager - 演化管理
│  │  ├─ 完整交互循环处理
│  │  ├─ 兴趣图谱动态更新
│  │  ├─ 演化触发和执行
│  │  ├─ 互惠受益分数更新
│  │  └─ 系统健康度统计
│  │
│  └─ SessionManager - 会话管理
│     ├─ 多用户管理
│     ├─ 用户兴趣图谱维护
│     ├─ 交互历史记录
│     ├─ 会话持久化
│     └─ 用户档案生成

【应用和示例】
├─ main.py                  ⭐⭐
│  ├─ 演示工作流程（自动）
│  ├─ 交互模式（用户输入）
│  ├─ 结果展示和分析
│  └─ 会话保存功能
│
├─ advanced_examples.py      ⭐⭐
│  ├─ 医疗AI研究者演化示例
│  ├─ 跨领域探索示例
│  ├─ 负反馈恢复示例
│  └─ 复杂场景演示
│
├─ launcher.py              ⭐
│  ├─ 交互式菜单界面
│  ├─ 环境检查
│  ├─ 多选项执行
│  └─ 快速启动入口

【文档和参考】
├─ README.md                ⭐⭐⭐ 完整项目说明
│  ├─ 系统概述
│  ├─ 工作流程详解
│  ├─ 快速开始指南
│  ├─ 模块说明
│  ├─ 关键算法
│  ├─ 使用场景
│  ├─ 性能指标
│  ├─ 数据格式
│  ├─ 故障排除
│  └─ 扩展开发
│
├─ ARCHITECTURE.py           ⭐⭐ 架构和设计
│  ├─ 项目结构树
│  ├─ 完整工作流程
│  ├─ 关键算法详解
│  ├─ 使用示例代码
│  └─ 扩展开发点
│
├─ PROJECT_SUMMARY.py        ⭐⭐ 项目总结
│  ├─ 核心特性详解
│  ├─ 与传统系统对比
│  ├─ 性能指标说明
│  ├─ 应用场景举例
│  ├─ 技术亮点
│  └─ 后续优化方向

【测试】
└─ test_system.py            ⭐
   ├─ 单元测试
   │  ├─ 兴趣图谱测试
   │  ├─ 智能体测试
   │  └─ 演化管理测试
   └─ 集成测试
      └─ 完整工作流测试
\"\"\"

QUICK_START = \"\"\"
🚀 快速开始指南
════════════════════════════════════════════════════════════════

【第1步】安装依赖
────────────
cd /Users/jiangshengyu/Documents/program/python/RecSystem
pip install -r requirements.txt

【第2步】选择运行方式

方式1️⃣  - 自动演示（推荐首选）
──────────────────────────
python main.py
• 自动演示系统的完整工作流程
• 展示推荐生成、反馈评估、演化过程
• 最后显示系统最终状态

方式2️⃣  - 交互模式
──────────────────────────
python main.py --interactive
• 输入查询词获取推荐
• 实时查看系统响应
• 输入 'profile' 查看用户档案
• 输入 'exit' 退出

方式3️⃣  - 高级示例
──────────────────────────
python advanced_examples.py
• 3个完整场景演示
• 展示系统的演化能力
• 显示性能指标曲线

方式4️⃣  - 单元测试
──────────────────────────
python -m unittest test_system.py -v
• 验证系统各模块功能
• 集成测试完整流程

方式5️⃣  - 交互式启动器
──────────────────────────
python launcher.py
• 菜单式选择各种模式
• 环境检查
• 完整的导航界面

【第3步】查看文档
────────────
• README.md           - 完整使用说明（必读）
• ARCHITECTURE.py     - 系统架构和算法（推荐阅读）
• PROJECT_SUMMARY.py  - 项目总结和对比（了解要点）
\"\"\"

FILE_DEPENDENCIES = \"\"\"
📚 文件依赖关系
════════════════════════════════════════════════════════════════

config.py (配置层)
  ↓ (被所有模块使用)
  ├─ agent_a.py
  ├─ agent_b.py
  ├─ interest_graph.py
  ├─ evolution_manager.py
  └─ main.py

interest_graph.py (数据层)
  ↓ (存储用户兴趣)
  ├─ agent_a.py (读取图谱生成推荐)
  ├─ evolution_manager.py (更新图谱)
  └─ main.py (查看图谱)

agent_a.py (推荐智能体)
  ↓ (生成推荐)
  ├─ agent_b.py (接收推荐进行评估)
  ├─ evolution_manager.py (协调两个智能体)
  └─ main.py (展示推荐)

agent_b.py (评估智能体)
  ↓ (评估和改进)
  ├─ evolution_manager.py (触发演化)
  └─ main.py (展示评估结果)

evolution_manager.py (演化管理)
  ↓ (管理完整流程)
  ├─ SessionManager (多用户管理)
  ├─ main.py (主程序)
  ├─ advanced_examples.py (示例)
  └─ test_system.py (集成测试)

main.py, advanced_examples.py (应用层)
  ↓ (用户交互)
  └─ evolution_manager.py (核心逻辑)

test_system.py (测试层)
  ↓ (验证所有模块)
  └─ 所有其他模块
\"\"\"

KEY_CONCEPTS = \"\"\"
📖 核心概念速览
════════════════════════════════════════════════════════════════

【推荐系统的完整循环】

用户查询 
  ↓
智能体A (推荐)
  ├─ 利用兴趣图谱获取上下文
  ├─ 构造提示词
  ├─ 调用Qwen2.5模型
  ├─ 生成推荐列表
  └─ 排序优化
  ↓
推荐呈现
  ↓
用户反馈 (点击、浏览、满意度等)
  ↓
智能体B (评估)
  ├─ 计算质量评分
  ├─ 识别问题
  ├─ 生成改进建议
  └─ 学习规则
  ↓
兴趣图谱更新 (学习用户偏好)
  ↓
演化判定
  ├─ 检查质量评分趋势
  ├─ 检查改进信号
  └─ 决定是否演化
  ↓
[可选] 版本升级
  ├─ 智能体B学习新规则
  ├─ 智能体A应用改进
  └─ 系统能力提升
  ↓
重复 (不断演化适应)


【4个关键评估维度】

1. 点击率 (40%)
   = 用户点击的推荐数 / 总推荐数
   衡量：推荐的相关性

2. 浏览时长 (30%)
   = 用户在推荐上花费的时间 / 300秒
   衡量：推荐的吸引力

3. 转化 (20%)
   = 用户是否完成期望的行动
   衡量：最终的转化效果

4. 满意度 (10%)
   = 用户主观评分 (0-1)
   衡量：用户体验

质量评分 = Cr×0.4 + Br×0.3 + Cv×0.2 + Sa×0.1


【兴趣图谱的演化】

时间 →
┌────────────────────────────────────────────────┐
│ T0: 用户开始使用系统                             │
│ 兴趣节点: 0                                    │
│                                                │
│ T1: 用户查询 \"Python编程\"                     │
│ 兴趣节点: [\"Python\", \"编程\"]                │
│ 权重: 0.5, 0.5                               │
│                                                │
│ T2: 用户查询 \"数据分析\"                       │
│ 兴趣节点: [\"Python\", \"编程\", \"数据分析\"]  │
│ 权重: 0.65, 0.5, 0.5                         │
│ 关系: Python → 数据分析                       │
│                                                │
│ T3-T5: 继续交互                               │
│ 兴趣节点数增长到15                            │
│ 形成\"Python→数据分析→机器学习\"的学习路径   │
│                                                │
│ T6: 检测到改进趋势                            │
│ [触发演化] → 智能体版本升级                   │
│                                                │
│ T7+: 系统更聪明                               │
│ 推荐质量持续提升                              │
│ 兴趣图谱不断完善                              │
└────────────────────────────────────────────────┘


【演化如何改进系统】

演化前 (Version 1):
  推荐质量: 0.55 (不理想)
  点击率: 30%
  问题: 推荐不够相关，缺少多样性

[触发演化条件: 平均质量 < 0.6]

智能体B进化:
  分析失败模式: 相关性匹配不足
  学习规则: \"应该更看重关键词匹配\"
  新规则数: +3

智能体A进化:
  应用改进: 调整排序权重
  优化逻辑: 增加关键词匹配的权重
  版本更新: 1 → 2

演化后 (Version 2):
  推荐质量: 0.70 ↑↑ (改善)
  点击率: 45% ↑↑ (改善)
  用户满意度: 0.75 ↑ (改善)
  
[继续循环，多次演化后]

最终状态 (Version N):
  推荐质量: 0.85+ (优秀)
  用户满意度: 0.90+ (很好)
  系统: 已完全适应用户
\"\"\"

TIPS_AND_TRICKS = \"\"\"
💡 使用技巧和注意事项
════════════════════════════════════════════════════════════════

【获得最佳效果】

1. 第一次使用
   └─ 运行 'python main.py' 查看自动演示
   └─ 理解系统的工作原理
   └─ 查看推荐、评估、演化的完整过程

2. 进行真实交互
   └─ 运行 'python main.py --interactive'
   └─ 输入多个相关查询
   └─ 提供真实反馈（点击、浏览时间）
   └─ 观察系统如何适应

3. 理解兴趣图谱
   └─ 运行 'profile' 命令
   └─ 查看用户的主要兴趣和权重
   └─ 注意兴趣如何随交互演化

4. 监控系统健康
   └─ 关注互惠受益分数
   └─ 观察演化次数和阶段
   └─ 追踪性能指标趋势

【常见问题】

Q: 系统什么时候会演化？
A: 当满足以下条件之一时：
   • 最近5次的平均质量评分 < 0.6
   • 检测到显著改进趋势 (增加 > 0.15)

Q: 推荐质量为什么有时低？
A: 正常现象！系统会从这些反馈中学习。多进行几次交互，
   质量应该会提升。

Q: 如何让系统遗忘某个兴趣？
A: 系统会自动衰减长期未访问的兴趣。如果不点击某类推荐，
   其权重会逐周衰减到95%。

Q: 可以改用其他LLM吗？
A: 可以！编辑 config.py 的 MODEL_NAME:
   MODEL_NAME = \"Qwen/Qwen2.5-1.5B-Instruct\"

Q: 系统可以支持多少用户？
A: 理论上无限。每个用户维护独立的兴趣图谱和演化管理器。
   性能取决于服务器资源。

【性能优化建议】

1. 使用GPU
   └─ 系统会自动选择GPU（如果可用）
   └─ 推荐生成速度快10-50倍

2. 减少模型推理
   └─ 可以缓存热门查询的推荐
   └─ 为相似查询返回近似推荐

3. 图谱优化
   └─ 系统自动在1000节点时修剪
   └─ 可调整 MAX_GRAPH_SIZE 参数

4. 批处理
   └─ 处理多个用户时，并行处理独立会话
   └─ 使用 SessionManager 的多用户支持

【扩展开发建议】

1. 添加新的反馈维度
   └─ 编辑 agent_b.py 的 FeedbackMetrics
   └─ 在质量评分中调整权重

2. 自定义排序算法
   └─ 编辑 agent_a.py 的 _rank_recommendations
   └─ 实现行业特定的优化逻辑

3. 实现API服务
   └─ 将 SessionManager 封装为REST API
   └─ 支持远程调用

4. 可视化仪表板
   └─ 实时显示兴趣图谱
   └─ 追踪性能指标
   └─ 演化历史展示
\"\"\"

if __name__ == \"__main__\":
    print(FILES_OVERVIEW)
    print(\"\\n\" + \"=\"*80)\n    print(QUICK_START)
    print(\"\\n\" + \"=\"*80)\n    print(FILE_DEPENDENCIES)
    print(\"\\n\" + \"=\"*80)\n    print(KEY_CONCEPTS)
    print(\"\\n\" + \"=\"*80)\n    print(TIPS_AND_TRICKS)
"